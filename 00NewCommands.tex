% Comments
\newcommand{\mattia}[1]{\hspace*{0,01pt}\todo[color=NTNUBlue!40]{#1}}

% Generic math
\newcommand{\N}{\mathbb{N}}
\newcommand{\Prob}{{Pr}}

% sstandard notation
\mathchardef\mhyphen="2D          % hyphen for math mode
\newcommand{\spandots}{\,..\,}
\newcommand{\sspan}[2]{[{#1}\spandots{#2}]} % single span
\newcommand{\bits}{\{0,1\}}
\newcommand{\size}[1]{\left\lvert #1 \right\rvert}

% for games
\newcommand{\game}{\mathrm{G}}
\newcommand{\commentseparator}{{\color{black!65}\smash{\textbackslash\!\!\textbackslash\hspace{0.1em}}}}
\newcommand{\codecomment}[1]{%
	\nicorightaligned{%
		\scriptsize{%
			\commentseparator%
			{%
				#1%
			}%
		}%
	}%
}

%\newcommand{\eike}[1]{\textcolor{red}{(ek)~#1}}
\newcommand{\jpnote}[1]{\textcolor{darkgreen}{(jp)~#1}}
\newcommand{\doreen}[1]{\textcolor{magenta}{(dr)~#1}}
\newcommand{\magnus}[1]{\textcolor{red}{(mr)~#1}}
\newcommand{\chen}[1]{\textcolor{magenta}{(ch)~#1}}
\definecolor{darkgreen}{rgb}{0,0.5,0}

\newcommand{\gbox}[1]{\colorbox{lightgray}{#1}}

\newcommand{\getsr}{\gets_{\scriptscriptstyle\$}} %dollar behind arrow
\renewcommand{\getsr}{\mathrel{\vbox{\offinterlineskip\ialign{
				\hfil##\hfil\cr
				\hspace{0.1em}$\scriptscriptstyle\$$\cr
				$\leftarrow$\cr
}}}} %dollar on arrow


% the next block of code resolves \advX to the proper font for the aversary X
\def\makeuppercase#1{
	\expandafter\newcommand\csname cal#1\endcsname{\mathcal{#1}}
	\expandafter\newcommand\csname adv#1\endcsname{\mathcal{#1}}
	\expandafter\newcommand\csname frak#1\endcsname{\mathfrak{#1}}
	\expandafter\newcommand\csname bb#1\endcsname{\mathbb{#1}}
	\expandafter\newcommand\csname bf#1\endcsname{\textbf{#1}}
}
\newcounter{char}
\setcounter{char}{1}
\loop
\edef\Letter{\Alph{char}}
\expandafter\makeuppercase\Letter
\stepcounter{char}
\unless\ifnum\thechar>26
\repeat

%Pseudocode
%\newcommand{\pcfor}{\textbf{for }}
%\newcommand{\pcif}{\textbf{if }}
\newcommand{\pcor}{\textbf{or }}
\newcommand{\pcand}{\textbf{and }}
%\newcommand{\pcelse}{\textbf{else }}
%\newcommand{\pcelseif}{\textbf{else if }}
%\newcommand{\pcreturn}{\textbf{return }}
\newcommand{\pcoutput}{\textbf{output }}
\newcommand{\pcfetch}{\textbf{fetch }}
\newcommand{\abort}{\textbf{abort}}
\newcommand{\pcst}{\textbf{s.t. }}
%\newcommand{\pcabort}{\textbf{abort}}
\newcommand{\gcom}[1]{\hfill $\sslash$#1}
\newcommand{\incr}{\texttt{++}}

\setlength{\textfloatsep}{10pt plus 1.0pt minus 2.0pt}

%%%%%% - TODO Notes - %%%%%%
\newlength{\strutdepth}%
\settodepth{\strutdepth}{\strutbox}%

\newcommand{\notes}[3]{ %framework for margin notes of any kind
	\noindent{%\bfseries
		\color{#1}{#3}\color{#1}}%
	\strut\vadjust{\kern-\strutdepth%
		\vtop to \strutdepth{%
			\baselineskip\strutdepth%
			\vss\llap{{\large\color{#1}\textbf{#2}\quad\color{black}}}\null%
}}}

%\newcommand{\todo}[1]{\notes{red}{\small{TODO}}{#1}} %replaced by the cleaner package
\newcommand{\notice}[1]{\notes{blue}{\small{NOTE}}{#1}}
\newcommand{\todored}[1]{\textcolor{red}{#1}}
%%%%%% - TODO Notes - %%%%%%

\usepackage{array}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}


% Funktionen, um Games automatisch durchzunummerieren

\newcommand{\before}[1]{\the\numexpr\value{#1}-1\relax}

\newcommandx{\gamewBit}[4][1=, 2=]{{G_{#3,#4}^{#1}}^{#2}} %two optional arguments, one for the adversary in superscript and one for a case identifier
\newcommandx{\probwBit}[4][1=, 2=]{\Pr [\gamewBit[#1][#2]{#3}{#4} \Rightarrow 1 ]}

\renewcommandx{\game}[3][1=, 2=]{\gamewBit[#1][#2]{#3}{b}}
\newcommandx{\probs}[3][1=, 2=]{\probwBit[#1][#2]{#3}{b}}

\newcommandx{\distGames}[3][1=, 2=]{
	\left|\Pr[\game[#1][#2]{\arabic{#3}} \Rightarrow 1]
	-\Pr[\game[#1][#2]{\before{#3}} \Rightarrow 1]\right|
}% G_{i,b}-G_{i-1,b}

\newcommandx{\distAdv}[3][1=, 2=]{
	\left|\Pr[\gamewBit[#1][#2]{\arabic{#3}}{1} \Rightarrow 1]
	- \Pr[\gamewBit[#1][#2]{\arabic{#3}}{0} \Rightarrow 1]\right|
}% G_{i,1}-G_{i,0}

\newcommandx{\gamePlain}[2][1=]{G_{#2}^{#1}}
\newcommandx{\probPlain}[2][1=]{\Pr[\gamePlain[#1]{#2} \Rightarrow 1 ]}

\newcommandx{\gamePlainDiff}[3][1=]{G_{#2\text{-}#3}^{#1}}

\newcommandx{\distGamesPlain}[2][1=]{
	\left|\Pr[\gamePlain[#1]{\arabic{#2}} \Rightarrow 1]
	-\Pr[\gamePlain[#1]{\before{#2}} \Rightarrow 1]\right|
}% G_{i}-G_{i-1}



\newcommand{\heading}[1]{{\vspace{1ex}\noindent\sc{\smash{#1}}}}
%\newcommand{\heading}[1]{{\vspace{1ex}\noindent\sc{\underline{\smash{#1}}}}}


\newcommand{\bool}[1]{\llbracket #1\rrbracket}

\newcommand{\highlight}[1]{\colorbox{white}{$\displaystyle #1$}}

%\newcommand{\Bin}{\mathbb{F}_2}
\newcommand{\Bin}{\{0,1\}}
\newcommand{\Comp}{\mathbb{C}}
\newcommand{\G}{\mathbb{G}}
\newcommand{\Group}{\mathbb{G}}
\newcommand{\uni}{\getsr}
%\newcommand{\st}{\mathit{st}}

\newcommand{\Zp}{\bbZ_p}
\newcommand{\Zq}{\bbZ_q}
\newcommand{\Zn}{\bbZ_n}
\newcommand{\ZN}{\bbZ_N}
\newcommand{\ZS}{\bbZ_S}
\newcommand{\Fp}{\bbF_p}


%Games
\newcommand{\Adv}{\mathrm{Adv}}
\newcommand{\ddh}{\mathsf{ddh}}
\newcommand{\DDH}{\mathsf{DDH}}
\renewcommand{\DH}{\mathsf{DH}}
\newcommand{\DL}{\mathsf{DLog}}
\newcommand{\CDH}{\mathsf{CDH}}
\newcommand{\AdA}{\mathcal{A}}
\newcommand{\AdB}{\mathcal{B}}
\newcommand{\AdC}{\mathcal{C}}
\newcommand{\A}{\AdA}
\newcommand{\B}{\AdB}
\newcommand{\C}{\AdC}
\newcommand{\AdD}{\mathcal{D}}
\newcommand{\AdF}{\mathcal{F}}
\newcommand{\AdE}{\mathcal{E}}
\newcommand{\Language}{\mathcal{L}}

%Flags
\newcommand{\BAD}{\mathsc{BAD}}
\newcommand{\BADSTATE}{\mathsc{BAD_{State}}}
\newcommand{\BADCORRUPT}{\mathsc{BAD_{Corrupt}}}
\newcommand{\QUERY}{\mathsc{QUERY}}
\newcommand{\CHAL}{\mathsc{CHAL}}
\newcommand{\COLL}{\mathsc{COLL}}
%\newcommand{\BREAKSIG}{\mathsf{BREAK}_\mathsf{SIG}}
%\newcommand{\BREAKMAC}{\mathsf{BREAK}_\mathsf{MAC}}
\newcommand{\FORGE}{\mathsf{FORGE}}
%\newcommand{\QUERYIV}{\mathsc{QUERY_{\stateIV}}}
\newcommand{\AbortDer}{\mathsf{AbortDer}}
\newcommand{\AbortDerI}{\mathsf{AbortDer_{\mathsf{I}}}}
\newcommand{\AbortDerR}{\mathsf{AbortDer_{\mathsf{R}}}}
\newcommand{\Forge}{\Sigma}

%Security/Game Notions
\newcommand{\MUIMPKOA}{\MU\IMP\KOA}
\newcommand{\OW}{\mathsf{OW}\text{-}}
\newcommand{\MU}{\mathsf{MU}\text{-}}
\newcommand{\MUC}{\mathsf{MUC}\text{-}}
\newcommand{\MC}{\mathsf{MC}\text{-}}
\newcommand{\IND}{\mathsf{IND}\text{-}}
\newcommand{\LR}{\mathsf{LR}}
\newcommand{\CPA}{\mathsf{CPA}}
\newcommand{\CCA}{\mathsf{CCA}}
\newcommand{\atk}{\mathsf{ATK}}
\renewcommand{\AA}{\mathsf{AA}}
\newcommand{\StAA}{\mathsf{StAA}}
\newcommand{\AKEsecurityStates}{\mathsf{St}}
\newcommand{\AKEsecurityWeakStates}{\mathsf{wSt}}
\newcommand{\AKEsecurityPFS}{\mathsf{FS}}
\newcommand{\AKEsecurityPFSGame}{\IND\AKEsecurityPFS}
\newcommand{\AKEsecurityPFSGameStates}{\AKEsecurityPFSGame\text{-}\AKEsecurityStates}
\newcommand{\AKEsecurityPFSGameWeakStates}{\AKEsecurityPFSGame\text{-}\AKEsecurityWeakStates}
\newcommand{\AKEsecurityWPFS}{\mathsf{wFS}}
\newcommand{\AKEsecurityWPFSGame}{\IND\AKEsecurityWPFS}
\newcommand{\AKEsecurityWPFSGameStates}{\AKEsecurityWPFSGame\text{-}\AKEsecurityStates}
\newcommand{\AKEsecurityWPFSGameWeakStates}{\securityWPFSGame\text{-}\AKEsecurityWeakStates}
\newcommand{\AKEsecurityWeak}{\mathsf{XXX}}
\newcommand{\AKEsecurityWeakGame}{\IND\AKEsecurityWeak}
\newcommand{\AKEsecurityWeakGameStates}{\AKEsecurityWeakGame\text{-}\AKEsecurityStates}
\newcommand{\AKEsecurityWeakGameWeakStates}{\AKEsecurityWeakGame\text{-}\AKEsecurityWeakStates}

\newcommand{\AKEsecurityGame}{\IND\mathsf{\atk}}

\newcommand{\VKE}{\mathsf{VKE}}
\newcommand{\OWPA}{\OWPV}
\newcommand{\OWPV}{\mathsf{OW\hyphen HV}}
\newcommand{\OWPVname}{One-Wayness against Honest and key Verification attacks}

\newcommand{\AKEsecurityWPFSGameStatesR}{{\AKEsecurityWPFSGameStates^*}}

%\newcommand{\SigMUStrongSecurityGame}{N\mathsf{\text{-}SUF\text{-}CMA}}
%\newcommand{\SigStrongSecurityGame}{\mathsf{SUF\text{-}CMA}}
%\newcommand{\SigMUSecurityGame}{N\text{-}\mathsf{EUF\text{-}CMA^{corr}}}
%\newcommand{\MACMKSecurityGame}{\mathsf{MK\text{-}SUF\text{-}CMVA^{corr}}}


%\newcommand{\VAR}{\mathsf{VAR}}
%\newcommand{\action}{act}
%\newcommand{\prohibitedActions}{\text{Restrictions}}
%\newcommand{\varValue}{\text{value}}
%\newcommand{\SecurityNotion}{\IND\atk}
%\newcommand{\strategy}{\text{strategy}}
%\newcommand{\strategies}{\text{strategies}}
\newcommand{\attack}{\text{attack}}
%\newcommand{\attacks}{\text{attacks}}
%\newcommand{\validAttacks}{\text{validAttacks}}

\newcommand{\checkValidity}{
	\item \pcfor $\sid^*\in\testSessions$
	\item \quad \pcif $\FreshnessO(\sid^*)=\false~\pcreturn 0$
	\item \quad \pcif $\ValidAttackO(\sid^*)=\false~\pcreturn 0$
}





%Spaces
\newcommand{\MSpace}{\mathcal{M}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\RSpace}{\mathcal{R}}
\newcommand{\KSpace}{\mathcal{K}}
\newcommand{\PKSpace}{\mathcal{PK}}
\newcommand{\SKSpace}{\mathcal{SK}}
\newcommand{\ForgeSet}{\mathcal{F}}
%\newcommand{\PKtSpace}{\widetilde{\mathcal{PK}}}
%\newcommand{\CSpace}{\mathcal{C}}
%\newcommand{\VSpace}{\mathcal{V}}

%\newcommand{\EncQueries}{\mathcal{E}}
%\newcommand{\DecQueries}{\mathcal{D}}
%\newcommand{\DectQueries}{\widetilde{\mathcal{D}}}
%\newcommand{\HashQueries}{\mathcal{H}}
%\newcommand{\StateHashQueries}{\mathcal{G}}
%\newcommand{\MACHashQueries}{\mathcal{F}}
%\newcommand{\HashtQueries}{\widetilde{\mathcal{H}}}
%\newcommand{\EncQueriesMC}{\mathcal{MC}}
%\newcommand{\EncQueriesC}{\mathcal{C}}
%\newcommand{\EncQueriesCt}{\widetilde{\mathcal{C}}}
%\newcommand{\EncQueriesCK}{\mathcal{CK}}
%\newcommand{\EncQueriesCKt}{\widetilde{\mathcal{CK}}}

\newcommand{\PKSet}{\mathcal{PK}}




\newcommand{\GroupGen}{\mathsf{GGen}}
\newcommand{\PG}{\mathcal{PG}}



%\newcommand{\maxchallenges}{q_E}
%\newcommand{\maxchallengesPRF}{q_\prf}


%HPS
%\newcommand{\HPS}{\mathsf{HPS}}
%\newcommand{\ParameterGeneration}{\mathsf{Par}}
%\newcommand{\PrivateEvaluation}{\mathsf{Priv}}
%\newcommand{\PublicEvaluation}{\mathsf{Pub}}
%\newcommand{\subsetMembership}{\mathsf{SM}}
%\newcommand{\msubsetMembership}{m-\subsetMembership}
%\newcommand{\projectKey}{\mu}
%\newcommand{\computeA}{\mathsf{CompPriv}}
%\newcommand{\hashFunctionHPS}{\Lambda}
%\newcommand{\securityParameter}{\kappa}


%PKE
\newcommand{\PKE}{\mathsf{PKE}}
\newcommand{\KG}{\mathsf{Gen}}
\newcommand{\Gen}{\KG}
\newcommand{\E}{\mathsf{Enc}}
\newcommand{\D}{\mathsf{Dec}}
\newcommand{\F}{\mathsf{FakeEnc}}
\newcommand{\InitI}{\mathsf{Init}_{\textsc{I}}}
\newcommand{\InitR}{\mathsf{Init_{R}}}
\newcommand{\DerR}{\mathsf{Der_{R}}}
\newcommand{\DerL}{\mathsf{Der}_{\textsc{I}}}
\newcommand{\DerI}{\DerL}
\renewcommand{\st}{\text{st}}
\newcommand{\stateIni}{\text{st}_{i}}
\newcommand{\stateResp}{\text{st}_{r}}
\newcommand{\sid}{\sID}
\newcommand{\sida}{\sid_1}
\newcommand{\sidb}{\sid_2}

\newcommand{\param}{\mathsf{par}}
%\newcommand{\xmark}{\text{\ding{55}}}

\newcommand{\Set}{\mathcal{S}}
\newcommand{\SetCorr}{\mathcal{S}^{\mathsf{corr}}}

\newcommand{\KE}{\mathsf{KE}}
\newcommand{\DHKE}{\KE_{\mathsf{DH}}}
\newcommand{\GenKE}{\mathsf{Gen_{KE}}}
\newcommand{\GenAKE}{\mathsf{Gen_{AKE}}}
\newcommand{\GenVKE}{\mathsf{Gen_{VKE}}}


%\newcommand{\pkt}{\widetilde{\pk}}
%\newcommand{\skt}{\widetilde{\sk}}
%\newcommand{\ct}{\tilde{c}}
%\newcommand{\Kt}{\widetilde{K}}
%\newcommand{\xt}{\tilde{x}}
%\newcommand{\Xt}{\widetilde{X}}
%\newcommand{\mac}{\pi}


\newcommand{\Party}{\mathsf{P}}




%Oracles
\newcommand{\DecO}{\mathsc{Dec}}
\newcommand{\EncO}{\mathsc{Enc}}
\newcommand{\CorruptO}{\mathsc{Corr}}
\newcommand{\SignO}{\mathsc{Sign}}
\newcommand{\HashAO}{\hat{\mathsc{H}}}
\newcommand{\HashBO}{\mathsc{Hash}_2}
\newcommand{\ChallengeO}{\mathsc{Chall}}
\newcommand{\EncapsO}{\mathsc{Encaps}}
\newcommand{\DecapsO}{\mathsc{Decaps}}
%\newcommand{\TrivialO}{\mathsc{Trivial}}
%\newcommand{\TrivialAttackO}{\mathsc{TrivialAttack}}
%\newcommand{\AttackO}{\mathsc{Attack}}
%\newcommand{\EstO}{\mathsc{Est}}
%\newcommand{\InitO}{\mathsc{Init}}
%\newcommand{\DerrespO}{\mathsc{Der_{\mathsf{resp}}}}
\newcommand{\ContinueSessionLO}{\mathsc{Der_{\mathsc{I}}}}
\newcommand{\ContinueSessionRO}{\mathsc{Der_{\mathsf{R}}}}
\newcommand{\RevealO}{\mathsc{Reveal}}
\newcommand{\RevstateO}{\mathsc{Rev\text{-}State}}
\newcommand{\TestO}{\mathsc{Test}}
\newcommand{\ValidAttackO}{\mathsc{Valid}}
\newcommand{\FreshnessO}{\mathsc{Fresh}}
%\newcommand{\DefineVariablesO}{\mathsc{DefVar}}
\newcommand{\ExecuteO}{\mathsc{Exe}}
\newcommand{\KeyvfyO}{\mathsc{KVer}}

%AKE-Game Variables
\newcommand{\cnt}{\text{cnt}}
\newcommand{\cntS}{\text{cnt}_{\text{S}}}
\newcommand{\sID}{\text{sID}}
\newcommand{\leftparty}{\text{init}}
\newcommand{\rightparty}{\text{resp}}
%\newcommand{\sent}{\text{sent}}
%\newcommand{\received}{\text{received}}
\newcommand{\skeys}{\text{sKey}}
\newcommand{\states}{\text{state}}
%\newcommand{\rightstates}{\text{r-state}}
\newcommand{\revealed}{\text{revealed}}
\newcommand{\revealedState}{\text{revState}}
\renewcommand{\state}{\text{st}}
\newcommand{\corrupted}{\text{corrupted}}
\newcommand{\peercorrupted}{\text{peerCorrupted}}
\newcommand{\type}{\text{type}}
\newcommand{\typeRight}{\tabtypeRight}%{\text{``Resp''}}
\newcommand{\typeLeft}{\tabtypeLeft}%{\text{``Init''}}
%\newcommand{\ptr}{\text{ptr}}
%\newcommand{\pkEph}{\tilde{\pk}}
%\newcommand{\skEph}{\tilde{\sk}}
%\newcommand{\mEph}{\tilde{m}}
%\newcommand{\cEph}{\tilde{c}}
\newcommand{\matchingSessions}{\mathfrak{M}(\sID^*)}
%\newcommand{\sessionLeft}{\sID_{\textnormal{init}}^*}
%\newcommand{\sessionRight}{\sID_{\textnormal{resp}}^*}
%\newcommand{\guessSessionLeft}{s_{\textnormal{init}}'}
%\newcommand{\guessSessionRight}{s_{\textnormal{resp}}'}
\newcommand{\testSessions}{\mathcal{S}}
%\newcommand{\peerCorrupted}{\text{peerCorrupted}}
%\newcommand{\pkEnc}[1]{\pk_{#1}}
%\newcommand{\pkSign}[1]{\mathsf{vk}_{#1}}
%\newcommand{\skEnc}[1]{\sk_{#1}}
%\newcommand{\skSign}[1]{\mathsf{sigk}_{#1}}


%sigma-protocol security notions
\newcommand{\Sim}{{\mathsf{Sim}}}
\newcommand{\Sima}{\Sim_1}
\newcommand{\Simb}{\Sim_2}
\newcommand{\SKTrans}{{\mathsf{SKTrans}}}

\newcommand{\SKTransO}{{\orfont{SKTrans}}}
\newcommand{\Extra}{{\mathsf{Extract}}}
%\newcommand{\ID}{{\mathsf{ID}}}

\newcommand{\pkSigma}{{\text{\pk}}}

\newcommand{\skNew}[1]{\sk_{#1}'}
\newcommand{\pkNew}[1]{\pk_{#1}'}

\newcommand{\statePlain}{\state'}
\newcommand{\statesPlain}{\states'}
%\newcommand{\stateIV}{IV}
%\newcommand{\stateEnc}{\psi}
%\newcommand{\stateKey}{k}

\newcommand{\PartyIni}{\mathsf{P}_{\ini}}
\newcommand{\PartyResp}{\mathsf{P}_{\resp}}


\newcommand{\ini}{i}
\newcommand{\resp}{r}
\newcommand{\counterN}{n}
\newcommand{\counterS}{s}
\newcommand{\messageIni}{m_{\ini}}
\newcommand{\messageIniRes}{m_{j}}
\newcommand{\messageIpair}{\mathsf{Msg_I}}
\newcommand{\messageResp}{m_{\resp}}
\newcommand{\messageRpair}{\mathsf{Msg_R}}
\newcommand{\sigIni}{\sigma_{\ini}}
\newcommand{\sigResp}{\sigma_{\resp}}

\newcommand{\pmsgInit}{X}
\newcommand{\pmsgResp}{Y}
\newcommand{\CDHA}{A}
\newcommand{\CDHB}{B}
\newcommand{\cdha}{a}
\newcommand{\cdhb}{b}
\newcommand{\CDHZ}{Z}
\newcommand{\GCDHA}{C}
\newcommand{\GCDHZ}{D}
\newcommand{\rnd}{\alpha}
\newcommand{\WinSCDH}{\mathsf{Win}_{\SCDH}}
\newcommand{\WinSIG}{\mathsf{Win}_{\scufcma}}
\newcommand{\WinOWPV}{\mathsf{Win}_{\OWPV}}
\newcommand{\WinOWGPV}{\mathsf{Win}_{\GOWPV}}

%\newcommand{\originOracles}{\mathfrak{O}(\sID^*)}
\newcommand{\partialMatchingSessions}{\mathfrak{P}(\sID^*)}

\newcommand{\Hash}{\mathsf{H}}
\newcommand{\ROF}{\mathsf{F}}
\newcommand{\ROG}{\mathsf{G}}
\newcommand{\QCORRUPT}{Q_{\mathsf{Corrupt}}}
\newcommand{\QCHAL}{Q_{\mathsf{Chall}}}

\newcommand{\ROH}{\mathsf{H}}
\newcommand{\ROHp}{\mathsf{H}'}
\newcommand{\ROHt}{\widetilde{\mathsf{H}}}
\newcommand{\ROState}{\mathsf{G}}
\newcommand{\ROMAC}{\ROF}
\newcommand{\Oracle}{\mathsc{O}}
\newcommand{\List}[1]{\mathcal{L}_{#1}}
\newcommand{\Winning}{\mathsf{Win}}
%\newcommand{\lengthROState}{d}
%\newcommand{\lengthROMAC}{\kappa}

\newcommand{\Rightarrowrom}{\stackrel{\mathrm{\scalebox{.6}{ROM}}}{\Rightarrow}}


\newcommand{\emphDiff}[1]{{\leavevmode\color{black}#1}}
%\newcommand{\emphDiff}[1]{\leavevmode\gbox{#1}}
%\newcommand{\emphStateEncryption}[1]{{\leavevmode\color{purple}#1}}
\newcommand{\colorTrivial}{gray}
\newcommand{\explainBlueColor}{Lines written in blue color highlight the differences to the corresponding games.}
\newcommand{\explainBoldLine}{\textbf{bold} line numbers}
\newcommand{\emphItem}{
	\refstepcounter{nicocodei}%
	\item[\nicolinenrformatII{\thenicocodei}]}
%\nicorefprefix{nicocodei}{1}
%KEMs
\newcommand{\Kem}{\mathsf{KEM}}
\newcommand{\KEM}{\mathsf{KEM}}
\newcommand{\KemGen}{\mathsf{Gen}}
\newcommand{\Encaps}{\mathsf{Encaps}}
\newcommand{\Decaps}{\mathsf{Decaps}}
\newcommand{\GenKEM}{\mathsf{Gen_{KEM}}}
\newcommand{\OpenO}{\mathsc{Open}}
\newcommand{\KSpaceKEM}{\KSpace}

%CCA KEM
%\newcommand{\KEMCCA}{\KEM_{\CCA}}
%\newcommand{\GenCCA}{\Gen_{\CCA}}
%\newcommand{\EncapsCCA}{\Encaps_{\CCA}}
%\newcommand{\DecapsCCA}{\Decaps_{\CCA}}
%\newcommand{\KSpaceKEMCCA}{\KSpace}

%CPA KEM
%\newcommand{\KEMCPA}{\KEM_{\CPA}}
%\newcommand{\GenCPA}{\Gen_{\CPA}}
%\newcommand{\EncapsCPA}{\Encaps_{\CPA}}
%\newcommand{\DecapsCPA}{\Decaps_{\CPA}}
%\newcommand{\KSpaceKEMCPA}{\KSpace}

%AKE
\newcommand{\AKE}{\mathsf{AKE}}
\newcommand{\StartSessionLO}{\mathsc{Session_{\mathsc{I}}}}
\newcommand{\StartSessionRO}{\mathsc{Session_{\mathsf{R}}}}
\newcommand{\RegisterLTK}{\mathsc{RegisterLTK}}
\newcommand{\cntLTK}{\text{cnt}_{\text{P}}}

%\newcommand{\FindPotentialMatches}{\mathsc{PotentialMatch}}
\newcommand{\placeholder}{\hspace*{0.18em}\cdot\hspace*{0.18em}}
%\newcommand{\PotentialMatchingSessions}{\mathfrak{P}}

\newcommand{\context}{\text{ctxt}}

\newcommand{\Time}{\textnormal{Time}}
\newcommand{\suchthat}{\text{ s.\,t. }}
%\newcommand{\challengeKey}{\text{key}}
%\newcommand{\view}{\text{view}}
%\newcommand{\initvector}{\overrightarrow{\text{init}}}
%\newcommand{\opened}{\text{opened}}
\newcommand{\collisionProb}{\mu}
%\newcommand{\collisionProbCCA}{{\mu_\CCA}}
%\newcommand{\collisionProbCPA}{{\mu_\CPA}}
%\newcommand{\collisionProbSIG}{{\mu_\SIG}}
\newcommand{\spreadness}{\gamma}
%\newcommand{\spreadnessCCA}{{\gamma_\CCA}}
%\newcommand{\spreadnessCPA}{{\gamma_\CPA}}



%\newcommand{\Resp}{\mathsf{Resp}_{\textsc{R}}}
%\newcommand{\messageRespR}{R_{\textsc{R}}}
%\newcommand{\messageRespI}{R_{\textsc{I}}}

%\newcommand{\Kmac}{K_\mathsf{mac}}
%\newcommand{\FinR}{\mathsf{mac}_{\textsc{R}}}
%\newcommand{\FinI}{\mathsf{mac}_{\textsc{I}}}


\newcommand{\stateI}{\text{st}_{\mathsc{I}}}
\newcommand{\stateR}{\text{st}_{\mathsc{R}}}

%\newcommand{\AKEsecurityPFSGameStatesThreeMsg}{\AKEsecurityPFSGame\text{-}\AKEsecurityStates^{(3)}}


%\newcommand{\GuessKeyO}{\mathsc{GuessKey}}


\newcommand{\tabfalse}{$\mathbf{F}$}
\newcommand{\tabtrue}{$\mathbf{T}$}
\newcommand{\tabtypeRight}{\text{``Re''}}
\newcommand{\tabtypeLeft}{\text{``In''}}
\newcommand{\pSessions}{\mathcal{P}}

% protocols
\newcommand{\TiborAKE}{\mathsf{X3DH}^-}
\newcommand{\TiborNaxosAKE}{\mathsf{NAXOS}}
\newcommand{\NAXOS}{\mathsf{NAXOS}}
\newcommand{\HMQV}{\mathsf{HMQV}}
\newcommand{\CMQV}{\mathsf{CMQV}}
%\newcommand{\identity}[1]{\hat{\text{#1}}}%
\newcommand{\identity}[1]{\textbf{#1}}
\newcommand{\esk}{esk}
\newcommand{\lengthesk}{{\lambda}}
\newcommand{\msgIniDHExp}{x}
\newcommand{\msgIniDH}{X}
\newcommand{\msgResDHExp}{y}
\newcommand{\msgResDH}{Y}
\newcommand{\contextTiborAKE}{(A_i,A_r,\msgIniDH,\msgResDH)}
\newcommand{\contextHMQV}{(A_i,A_r,\msgIniDH,\msgResDH)}
\newcommand{\ID}{ID}
\newcommand{\IDi}[1]{ID_{#1}}
\newcommand{\outputSetROG}{\Zp}
\newcommand{\QROG}{Q_{\mathsc{\ROG}}}
\newcommand{\QROH}{Q_{\mathsc{\ROH}}}
\newcommand{\QRO}{Q_{\mathsc{RO}}}
\newcommand{\cntH}{\text{cnt}'}
\newcommand{\idx}{z}
\newcommand{\flag}{f}
\newcommand{\ListIni}{\List{\mathsf{I}}}


\newcommand{\AdvNDLog}[1]{\Adv^{(N)\text{-}\DL}_{\GroupGen}(#1)}
\newcommand{\AdvDLog}[1]{\Adv^{\DL}_{\GroupGen}(#1)}

% CorrICDH, etc
\newcommand{\SCDH}{\mathsf{StCDH}}
\newcommand{\GCDH}{\mathsf{GapCDH}}
\newcommand{\CorrCDH}{\mathsf{Corr}\GCDH}
\newcommand{\CorrACDH}{\mathsf{CorrA}\GCDH}
\newcommand{\CorrICDH}{\mathsf{CorrCR}\GCDH}
\newcommand{\PaCDH}{\mathsf{Pa}\hyphen \CDH}
%\newcommand{\SCDH}{\mathsf{CDH}^{\circ}}
%\newcommand{\GCDH}{\mathsf{CDH}^\bullet}
%\newcommand{\CorrCDH}{\mathsf{CorrCDH}^\circ}
%\newcommand{\CorrACDH}{\mathsf{CorrACDH}^\circ}
%\newcommand{\CorrICDH}{\mathsf{CorrCRCDH}^\bullet}

\newcommand{\AssGCDH}[1]{#1\mbox{-}\GCDH}
\newcommand{\AssSCDH}[1]{(#1)\mbox{-}\SCDH}
\newcommand{\NSCDH}[1]{#1\hyphen\SCDH}
\newcommand{\AssNSCDH}[1]{{#1}\hyphen \SCDH}
\newcommand{\ExpCDH}[1]{\CDH_{#1}}
\newcommand{\ExpSCDH}[1]{{\SCDH_{#1}}}
\newcommand{\ExpGCDH}[1]{{\GCDH_{#1}}}
\newcommand{\ExpCorrICDH}[1]{{\CorrICDH_{#1}}}
\newcommand{\AssCorrICDH}[1]{(#1)\mbox{-}\CorrICDH}
\newcommand{\ExpCorrCDH}[1]{{\CorrCDH_{#1}}}
\newcommand{\AssCorrCDH}[1]{#1\mbox{-}\CorrCDH}
\newcommand{\ExpCorrACDH}[1]{{\CorrACDH_{#1}}}
\newcommand{\AssCorrACDH}[1]{(#1)\mbox{-}\CorrACDH}
%\newcommand{\DlogO}{\mathsc{Dlog}}
\newcommand{\DlogO}{\mathsc{Corrupt}}
\newcommand{\DlogOp}{\mathsc{Corrupt'}}
%\newcommand{\ADlogO}{\mathsc{Corrupt}^-}
\newcommand{\IntO}{\mathsc{Ch}}
\newcommand{\counterI}{i}
\newcommand{\ForgeryVal}{C}
\newcommand{\AList}{\mathcal{L}_A}
\newcommand{\RList}{\mathcal{L}_R}
\newcommand{\ChSet}{\Zp}
\renewcommand{\secpar}{\lambda}
\newcommand{\AdvCorrICDH}[2]{\Adv^{\CorrICDH}_{#1}(#2)}
\newcommand{\AdvCorrCDH}[2]{\Adv^{\CorrCDH}_{#1}(#2)}
\newcommand{\AdvCorrACDH}[2]{\Adv^{\CorrACDH}_{#1}(#2)}
\newcommand{\AdvCDH}[2]{\Adv^{\CDH}_{#1}(#2)}
\newcommand{\AdvSCDH}[2]{\Adv^{\SCDH}_{#1}(#2)}
\newcommand{\AdvGCDH}[2]{\Adv^{\GCDH}_{#1}(#2)}
\newcommand{\AdvNSCDH}[3]{\Adv^{{#1}\hyphen\SCDH}_{#2}(#3)}
% GGM proof
\newcommand{\DLOG}{\mathsf{DLOG}}
\newcommand{\QG}{Q_{\G}}
\newcommand{\EList}{\mathcal{L}_E}
%\newcommand{\DDHO}{\mathsc{Ddh}}
\newcommand{\DDHO}{\mathsc{Dh}_{\cdha}}
\newcommand{\DDHOx}{\mathsc{Dh}_{x}}
\newcommand{\GDDHO}{\mathsc{Ddh}}
\newcommand{\BadGgm}[1]{\BAD_{\mathsf{#1}}}
\newcommand{\Badgrp}{\BadGgm{group}}
\newcommand{\Badgap}{\BadGgm{gap}}
\newcommand{\Badddh}{\BadGgm{DDH}}
\newcommand{\OpO}{\mathsc{Op}}
\newcommand{\gameboxA}[1]{\dashbox{#1}}
\newcommand{\gameboxB}[1]{\fbox{#1}}
\newcommand{\gameg}{\mathsf{G}}
\newcommand{\BADDDH}{\BAD_{\mathsc{Ddh}}}
\newcommand{\BADOp}{\BAD_{\G}}
\newcommand{\QOp}{Q_{\OpO}}
\newcommand{\Qddh}{Q_{\mathsc{Ddh}}}
\newcommand{\QDlog}{n'}
%\newcommand{\QInter}{Q}
\newcommand{\QInter}{Q_{\mathsc{Ch}} }
\newcommand{\GGM}{\mathrm{GGM}}
%\newcommand{\Qch}{Q_{\}}
	\newcommand{\StDH}{\mathsf{StDH}}
	\newcommand{\AdvStDH}[2]{\Adv^{\StDH}_{#1}(#2)}
	\newcommand{\FStDDHO}[1]{\mathsc{StDh}_1(#1)}
	\newcommand{\StDDHO}{\mathsc{StDh}}
	\newcommand{\DBStDH}{\GCDH}
	\newcommand{\AdvDBStDH}[2]{\Adv^{\DBStDH}_{#1}(#2)}
	\newcommand{\imply}[1]{\xrightarrow{{ #1}}}
	\newcommand{\equivalent}[1]{\xLeftrightarrow{{\tiny #1}}}
	\newcommand{\Imply}[1]{\xRightarrow{{ #1}}}
	%\newcommand{\ggmcnt}{P}
	
	\newcommand{\ncdh}{n}
	\newcommand{\nuser}{N}
	\newcommand{\GDH}{\mathsf{GDH}}
	\newcommand{\detgets}{:=}
	\newcommand{\rtape}{\rho}
	%\newcommand{\advC}{\AdC}
	%\newcommand{\advR}{\mathcal{R}}
	\newcommand{\acc}{\mathsf{acc}}
	\newcommand{\frk}{\mathsf{frk}}
	\newcommand{\IG}{\mathsf{IG}}
	\newcommand{\TIME}[1]{\mathbf{T}(#1)}
	\newcommand{\TIMEon}[1]{\mathbf{T}_{\mathrm{ON}}(#1)}
	\newcommand{\TIMEoff}[1]{\mathbf{T}_{\mathrm{OFF}}(#1)}
	
	\newcommand{\hyphen}{\mbox{-}}
	
	\newcommand{\nicosep}{\vspace{.6em}}
	\newcommand{\coin}{\bitSide}
	\newcommand{\guessI}{i^*}
	\newcommand{\guessJ}{j^*}
	
	\newcommand{\inHMQV}{\HMQV}
	\newcommand{\inCMQV}{\CMQV}
	\newcommand{\inNAXOS}{\TiborNaxosAKE}
	\newcommand{\inTiborAKE}{\TiborAKE}
	\newcommand{\inMQV}{\mathsf{MQV}}
	\newcommand{\ETDH}{\mathsf{X3DH}}
	\newcommand{\etal}{et al.}
	\newcommand{\toff}{t_\mathsc{off}}
	\newcommand{\ton}{t_\mathsc{on}}
	\newcommand{\epsAKE}{\varepsilon^{\AKE}}
	\newcommand{\epsASS}{\varepsilon^{\mathsf{Ass}}}
	\newcommand{\ROHB}{\bar{H}}
	\newcommand{\epsggicdhcorr}{\varepsilon^{\CorrICDH}}
	\newcommand{\epsggcdhcorr}{\varepsilon^{\CorrCDH}}
	\newcommand{\epsggacdhcorr}{\varepsilon^{\CorrACDH}}
	\newcommand{\oldepsHMQV}{\varepsilon^{\inHMQV}_{\mathsf{old}}}
	\newcommand{\newepsHMQV}{\varepsilon^{\inHMQV}_{\mathsf{new}}}
	\newcommand{\oldepsNAXOS}{\varepsilon^{\inNAXOS}_{\mathsf{old}}}
	\newcommand{\oldepsTiborAKE}{\varepsilon^{\inTiborAKE}_{\mathsf{old}}}
	\newcommand{\epsDL}{\varepsilon^{\mathsf{DL}}}
	%\newcommand{\advA}{\AdA}
	
	
	%definition 5-move
	\newcommand{\notionfont}[1]{\mathsf{#1}}
	\newcommand{\schemefont}[1]{{\mathsf{#1}}}
	\newcommand{\gamefont}[1]{{\mathsf{#1}}}
	\newcommand{\primfont}[1]{{\mathsf{#1}}}
	\newcommand{\algfont}[1]{{\mathsf{#1}}}
	\newcommand{\advfont}[1]{{\mathsf{#1}}}
	\newcommand{\orfont}[1]{\mathsc{#1}}      % Oracle font
	\newcommand{\procfont}[1]{\textsc{#1}}
	\newcommand{\varfont}[1]{\mathit{#1}}
	\newcommand{\randvarfont}[1]{\mathbf{#1}}
	\newcommand{\eventfont}[1]{{\mathsf{#1}}}
	\newcommand{\vectorfont}[1]{\mathbf{#1}}
	%\newcommand{\vectorfont}[1]{\mathslbf{#1}}
	\newcommand{\transformfont}[1]{\mathsf{#1}}
	\newcommand{\funfont}[1]{\mathsf{#1}}
	\newcommand{\spacefont}[1]{\mathcal{#1}}
	\newcommand{\setfont}[1]{\mathsf{#1}}
	
	
	
	\newcommand{\IDGen}{\algfont{IGen}}
	\newcommand{\IDProver}{\algfont{P}}
	\newcommand{\IDPO}{\algfont{P}_1}
	\newcommand{\IDPT}{\algfont{P}_2}
	\newcommand{\IDPa}{\IDProver_1}
	\newcommand{\IDPb}{\IDProver_2}
	\newcommand{\IDPc}{\IDProver_3}
	\newcommand{\IDResponse}{\algfont{R}}
	\newcommand{\IDVer}{\algfont{V}}
	\newcommand{\IDVera}{\IDVer_1}
	\newcommand{\IDVerb}{\IDVer_2}
	\newcommand{\IDSch}{\IDScheme}
	\newcommand{\IDCM}{\IDS_{\schemefont{CM}}}
	\newcommand{\IDTCM}{\IDS_{\TCM}}
	\newcommand{\IDCMb}{\IDTCM}
	\newcommand{\IDKW}{\IDS_{\schemefont{KW}}}
	\newcommand{\IDCP}{\IDS_{\schemefont{CP}}}
	\newcommand{\IDGQ}{\IDS_{\schemefont{GQ}}}
	\newcommand{\IDSchGen}{\IDGen}
	\newcommand{\IDSchProver}{\IDProver}
	\newcommand{\IDSchVer}{\IDVer}
	\newcommand{\KRKOA}{\notionfont{KR}\mbox{-}\notionfont{KOA}}
	\newcommand{\SSD}{\notionfont{SS}}
	\newcommand{\KRPA}{\notionfont{KR}\mbox{-}\notionfont{PA}}
	
	
	\newcommand{\IDVerO}{\procfont{Ver}}
	\newcommand{\Ext}{\algfont{Ext}}
	\newcommand{\Ctr}{j}
	\newcommand{\CMT}{R}
	\newcommand{\CMTa}{\CMT_1}
	\newcommand{\CMTb}{\CMT_2}
	\newcommand{\CMTL}{\CMT_L}
	\newcommand{\CMTR}{\CMT_R}
	\newcommand{\CMTas}{\CMTa^*}
	\newcommand{\CMTbs}{\CMTb^*}
	\newcommand{\CMTij}[2]{\CMT_{#1,#2}}
	\newcommand{\CH}{h}
	\newcommand{\CHa}{\CH_1}
	\newcommand{\CHb}{\CH_2}
	\newcommand{\CHij}[2]{\CH_{#1,#2}}
	\newcommand{\CHas}{\CHa^*}
	\newcommand{\CHbs}{\CHb^*}
	\newcommand{\RSP}{s}
	\newcommand{\RSPi}[1]{\RSP_{#1}}
	\newcommand{\STATE}{\varfont{St}}
	\newcommand{\STATEa}{\STATE_1}
	\newcommand{\STATEb}{\STATE_2}
	\newcommand{\CHSET}{\mathsf{ChSet}}
	\newcommand{\CHSETa}{\CHSET_1}
	\newcommand{\CHSETb}{\CHSET_2}
	\newcommand{\CHLista}{\mathcal{L}_1}
	\newcommand{\CHListb}{\mathcal{L}_2}
	\newcommand{\CHList}[1]{\mathcal{L}_{#1}}
	\newcommand{\CMTSET}{\mathsf{RSet}}
	\newcommand{\CHSize}{k}
	
	%5-move to signature Fiat-Shamir with corruption
	\newcommand{\IDScheme}{\mathsf{ID}}
	\newcommand{\FS}{\mathsf{FS}}
	\newcommand{\FSHash}{\mathsf{H}}
	\newcommand{\FSHasha}{\mathsf{H}_1}
	\newcommand{\FSHashb}{\mathsf{H}_2}
	\newcommand{\QueryFSHasha}{\notionfont{Q}_1}
	\newcommand{\QueryFSHashb}{\notionfont{Q}_2}
	\newcommand{\QuerySign}{\SignO}
	\newcommand{\cufcma}{\notionfont{CorrCMA}}
	\newcommand{\scufcma}{\notionfont{StCorrCMA}}
	\newcommand{\cufkoa}{\notionfont{Corr}\mbox{-}\allowbreak\notionfont{UF}\mbox{-}\allowbreak\notionfont{KOA}}
	\newcommand{\FSGen}{\algfont{Gen}}
	%\newcommand{\param}{\varfont{params}}
	
	\newcommand{\tab}{\hspace*{1em}}
	
	\newcommand{\FSVer}{\algfont{Ver}}
	\newcommand{\OFVer}{\FSVer_O}
	\newcommand{\FSSign}{\algfont{Sign}}
	\newcommand{\OFSign}{\FSSign_O}
	\newcommand{\mes}{\varfont{m}}
	\newcommand{\HASHa}{\algfont{H}_1}
	\newcommand{\HASHb}{\algfont{H}_2}
	\newcommand{\LIM}{\varfont{\ell}}
	
	\newcommand{\NumCorrQuery}{{Q}_{\textsc{Cor}}}
	%\newcommand{\NumChQuerya}{\notionfont{Q}_{\algfont{CH}_1}}
	%\newcommand{\NumChQueryb}{\notionfont{Q}_{\algfont{CH}_2}}
	%\newcommand{\NumHashQuerya}{\notionfont{Q}_1}
	%\newcommand{\NumHashQueryb}{\notionfont{Q}_2}
	\newcommand{\NumSignQuery}{{Q}_{s}}
	
	\newcommand{\ListFSHasha}{\mathcal{L}_{\HASHa}}
	\newcommand{\ListFSHashb}{\mathcal{L}_{\HASHb}}
	\newcommand{\signature}{\sigma}
	\newcommand{\INCONS}{\eventfont{INCONS}}
	
	
	% 5-move proof system
	\newcommand{\naHVZK}{\notionfont{naHVZK}}
	\newcommand{\HVZK}{\notionfont{HVZK}}
	\newcommand{\CPIMPKOA}{\notionfont{Corr}\mbox{-}\notionfont{PIMP}\mbox{-}\notionfont{KOA}}
	\newcommand{\proofCHa}{\notionfont{Q}_{\algfont{CH}_1}}
	\newcommand{\proofCHb}{\notionfont{Q}_{\algfont{CH}_2}}
	\newcommand{\AdvC}{\mathcal{C}}
	\newcommand{\AdvB}{\mathcal{B}}
	\newcommand{\AdvA}{\mathcal{A}}
	\newcommand{\CorrQuery}{\CorruptO}
	\newcommand{\ChQuerya}{\ChQuery_1}
	\newcommand{\ChQueryb}{\ChQuery_2}
	\newcommand{\DLX}{w^{\bitSide_i}}
	\newcommand{\DLXprime}{w^{1-\bitSide_i}}
	\newcommand{\Verif}{\SIGVer}
	\newcommand{\ChQueryRO}{\ChQuery^\RO}
	
	%identification scheme
	\newcommand{\KWGen}{\algfont{Gen}}
	\newcommand{\KWProveA}{\algfont{P}_1}
	\newcommand{\KWProveB}{\algfont{P}_2}
	\newcommand{\KWVer}{\algfont{V}}
	
	%KWvariable
	\newcommand{\Com}{\varfont{R}}
	\newcommand{\ComA}{\varfont{R}_0}
	\newcommand{\ComB}{\varfont{R}_1}
	
	\newcommand{\Corr}{\notionfont{Corr}\text{-}}
	\newcommand{\PIMP}{\notionfont{PIMP}\text{-}}
	\newcommand{\KOA}{\notionfont{KOA}}
	\newcommand{\RSR}{\notionfont{RSR}}
	\newcommand{\PIMPKOA}{\PIMP\KOA}
	
	%Tight Corr-ufcma signature with cdh
	\newcommand{\bitSide}{\varfont{d}}
	
	\newcommand{\CHaa}{\varfont{h}_{1,0}}
	\newcommand{\CHba}{\varfont{h}_{2,0}}
	\newcommand{\CMTaa}{\varfont{R}_{1,0}}
	\newcommand{\CMTba}{\varfont{R}_{2,0}}
	\newcommand{\CMTLa}{\varfont{R}_{L,0}}
	\newcommand{\CMTRa}{\varfont{R}_{R,0}}
	\newcommand{\RSPa}{\varfont{s}_0}
	
	\newcommand{\CHab}{\varfont{h}_{1,1}}
	\newcommand{\CHbb}{\varfont{h}_{2,1}}
	\newcommand{\CMTab}{\varfont{R}_{1,1}}
	\newcommand{\CMTbb}{\varfont{R}_{2,1}}
	\newcommand{\CMTLb}{\varfont{R}_{L,1}}
	\newcommand{\CMTRb}{\varfont{R}_{R,1}}
	\newcommand{\RSPb}{\varfont{s}_1}
	
	\newcommand{\randD}{\varfont{r}_\bitSide}
	\newcommand{\randa}{\varfont{r}_0}
	\newcommand{\randb}{\varfont{r}_1}
	\newcommand{\CHaD}{\varfont{h}_{1,\bitSide}}
	\newcommand{\CHbD}{\varfont{h}_{2,\bitSide}}
	\newcommand{\CMTaD}{\CMT_{1,\bitSide}}
	\newcommand{\CMTbD}{\CMT_{2,\bitSide}}
	\newcommand{\CMTLD}{\varfont{R}_{L,\bitSide}}
	\newcommand{\CMTRD}{\varfont{R}_{R,\bitSide}}
	\newcommand{\RSPD}{\varfont{s}_{\bitSide}}
	
	\newcommand{\randMinD}{\varfont{r}_{1-\bitSide}}
	\newcommand{\CHaMinD}{\varfont{h}_{1,1-\bitSide}}
	\newcommand{\CHbMinD}{\varfont{h}_{2,1-\bitSide}}
	\newcommand{\CMTaMinD}{\varfont{R}_{1,1-\bitSide}}
	\newcommand{\CMTbMinD}{\varfont{R}_{2,1-\bitSide}}
	\newcommand{\CMTLMinD}{\varfont{R}_{L,1-\bitSide}}
	\newcommand{\CMTRMinD}{\varfont{R}_{R,1-\bitSide}}
	\newcommand{\RSPMinD}{\varfont{s}_{1-\bitSide}}
	
	%def:
	\newcommand{\params}{\param}
	%SIG
	\newcommand{\SIG}{\primfont{SIG}}
	\newcommand{\FSSignO}{\procfont{Sign}}
	\newcommand{\OF}{\primfont{OF}}
	\newcommand{\OFGen}{\algfont{Gen}}
	\newcommand{\SIGS}{\primfont{SIG}}
	\newcommand{\SIGGen}{\algfont{Gen}}
	\newcommand{\SIGSign}{\algfont{Sign}}
	\newcommand{\SIGVer}{\algfont{Ver}}
	\newcommand{\SIGSignO}{\procfont{Sign}}
	\newcommand{\AdvUFCMA}[2]{\Adv^{\ufcma}_{#1}(#2)}
	\newcommand{\ufcma}{\UFCMA}
	\newcommand{\AdvSUFCMA}[2]{\Adv^{\sufcma}_{#1}(#2)}
	\newcommand{\SUFCMA}{\mathsf{St}\hyphen\UFCMA}
	\newcommand{\sufcma}{\SUFCMA}
	\newcommand{\AdvMSUFCMA}[2]{\Adv^{\msufcma}_{#1}(#2)}
	\newcommand{\msufcma}{\gamefont{mu\mbox{-}suf\mbox{-}cma}}
	\newcommand{\AdvUFKOA}[2]{\Adv^{\ufkoa}_{#1}(#2)}
	\newcommand{\ufkoa}{\gamefont{uf\mbox{-}koa}}
	%\newcommand{\UFKOA}{\gamefont{UF\mbox{-}KOA}}
	\newcommand{\MUSIG}{\primfont{MU}\mbox{-}\primfont{SIG}}
	\newcommand{\KP}{\primfont{KP}}
	\newcommand{\KPGen}{\primfont{KPGen}}
	\newcommand{\KPSign}{\primfont{KPSign}}
	\newcommand{\KPVer}{\primfont{KPVer}}
	\newcommand{\CR}{\mathsf{cr}}
	\newcommand{\CCR}{\notionfont{CR}}
	\newcommand{\MSp}{\spacefont{M}}
	\newcommand{\SIGSp}{\Sigma}
	
	\newcommand{\ATK}{\notionfont{ATK}}
	
	\newcommand{\IDO}{\procfont{O}}
	\newcommand{\IDTranO}{\procfont{Tran}}
	\newcommand{\SKTranO}{\algfont{SKTran}}
	\newcommand{\IDRejO}{\procfont{Dummy}}
	\newcommand{\IDChO}{\procfont{Ch}}
	\newcommand{\IDChOa}{\IDChO_1}
	\newcommand{\IDChOb}{\IDChO_2}
	\newcommand{\IDChOAa}{\IDChO'_1}
	\newcommand{\IDChOAb}{\IDChO'_2}
	\newcommand{\IDChOBa}{\IDChO_1}
	\newcommand{\IDChOBb}{\IDChO_2}
	\newcommand{\PA}{\notionfont{PA}}
	\newcommand{\QO}{Q_\procfont{O}}
	\newcommand{\IMP}{\notionfont{IMP}\text{-}}
	
	
	\newcommand{\ReRand}{\algfont{ReRand}}
	\newcommand{\Tran}{\algfont{Tran}}
	\newcommand{\DeRand}{\algfont{DeRand}}
	\newcommand{\transcript}{\varfont{T}}
	
	
	%text abrev
	\newcommand{\ie}{\textit{i.e.}}
	\newcommand{\wrt}{\textit{w.r.t. }}
	\newcommand{\WLOG}{\textit{W.L.O.G. }}
	\newcommand{\PPT}{\notionfont{PPT}}
	\newcommand{\PT}{\notionfont{PT}}
	
	
	%Convert ID -> Sig
	\newcommand{\IDpk}{\pk}
	\newcommand{\IDpka}{\pk_0}
	\newcommand{\IDsk}{\sk}
	\newcommand{\IDska}{\IDsk_0}
	\newcommand{\IDpkb}{\IDpk_1}
	\newcommand{\IDskb}{\IDsk_1}
	\newcommand{\IDpkD}{\IDpk_{\bitSide}}
	\newcommand{\IDskD}{\IDsk_{\bitSide}}
	\newcommand{\IDpkMinD}{\IDpk_{1-\bitSide}}
	\newcommand{\STATEaa}{\STATE_{1,0}}
	\newcommand{\STATEab}{\STATE_{1,1}}
	\newcommand{\STATEaD}{\STATE_{1,\bitSide}}
	\newcommand{\STATEaMinD}{\STATE_{1,1-\bitSide}}
	\newcommand{\STATEba}{\STATE_{2,0}}
	\newcommand{\STATEbb}{\STATE_{2,1}}
	\newcommand{\STATEbD}{\STATE_{2,\bitSide}}
	\newcommand{\STATEbMinD}{\STATE_{2,1-\bitSide}}
	
	%
	\newcommand{\RO}{\GHashO}
	\newcommand{\auxPIMPKOA}{\PIMP\allowbreak\KOA^\RO}
	\newcommand{\OauxPIMPKOA}{\PIMP\allowbreak\KOA^\RO}
	\newcommand{\ChQueryc}{\varfont{Q}_c}
	
	\newcommand{\ListChA}{\mathcal{L}_{1}}
	\newcommand{\ListChB}{\mathcal{L}_{2}}
	\newcommand{\counterA}{\counter_1}
	\newcommand{\counterB}{\counter_2}
	\newcommand{\WrongOrd}{\eventfont{BadOrd}}
	
	\renewcommand{\Game}{{G}}
	\newcommand{\SECDH}{\mathsf{SCDH}}
	
	\newcommand{\aux}{\mathsf{aux}}
	\newcommand{\anybits}{\bits^*}
	\newcommand{\delsta}{\Delta}
	
	%convert 3-move id to sig
	\newcommand{\MuPimpKoaRo}{\MU\allowbreak\PIMP\allowbreak\KOA^{\RO}}
	\newcommand{\MuImpKoaRo}{\MU\allowbreak\IMP\allowbreak\KOA_{\$}}
	\newcommand{\ChQuery}{\orfont{Ch}}
	\newcommand{\ListCh}{\mathcal{L}_{\ChQuery}}
	\newcommand{\NumChQuery}{{Q}_{\ChQuery}}
	\newcommand{\CMTD}{\CMT_\bitSide}
	\newcommand{\CMTDstar}{\CMT_{\bitSide^\star}}
	\newcommand{\CHD}{\CH_\bitSide}
	\newcommand{\CHDstar}{\CH_{\bitSide^\star}}
	\newcommand{\CMTMinD}{\CMT_{1-\bitSide}}
	\newcommand{\CMTMinDstar}{\CMT_{1-\bitSide^\star}}
	\newcommand{\CHMinD}{\CH_{1-\bitSide}}
	\newcommand{\CHMinDstar}{\CH_{1-\bitSide^\star}}
	\newcommand{\CMTA}{\CMT_0}
	\newcommand{\CMTB}{\CMT_1}
	\newcommand{\ChA}{\CH_0}
	\newcommand{\ChB}{\CH_1}
	\newcommand{\IDP}{\algfont{P}}
	\newcommand{\NumHashQuery}{{Q}_\Hash}
	\newcommand{\Qh}{Q_{\ROH}}
	
	%\newcommand{\QueryHash}{\orfont{Hash}}
	
	\newcommand{\counterHash}{\counter_{\algfont{H}}}
	\newcommand{\counter}{\cnt}
	\newcommand{\HashO}{\orfont{Hash}}
	\newcommand{\ListHash}{\List{\Hash}}
	\newcommand{\PRF}{\algfont{PRF}}
	
	
	%%signature: factoring
	\newcommand{\FAC}{\notionfont{FAC}}
	\newcommand{\BlumSet}{\setfont{Blum}}
	\newcommand{\Z}{\mathbb{Z}}
	\newcommand{\QRN}{\mathbb{QR}_N^+}
	\newcommand{\QR}{\mathbb{QR}_N}
	\newcommand{\multi}{\circ}
	\newcommand{\sexp}[2]{#1^{{#2}}}
	\newcommand{\CDHN}{\CDH_N}
	\newcommand{\ZNF}{\Z_{N/4}}
	\newcommand{\euler}{\varphi}
	\renewcommand{\P}{\mathbb{P}}
	
	%signature hash with prefix or not prefixa: H_1, prefixb: H_2
	%\newcommand{\prefixa}[1][]{\pk_{#1},}
	\newcommand{\prefixa}[1][]{}
	%\newcommand{\prefixb}[1][]{\pk_{#1},}
	\newcommand{\prefixb}[1][]{}
	
	\newcommand{\NumUser}{\mu}
	\newcommand{\NumSes}{S}
	\newcommand{\NumTest}{T}
	\newcommand{\NumVer}{Q_{V}}
	\newcommand{\NumROQ}{Q_\FSHash}
	\newcommand{\NumStO}{Q_{\textsc{Dh}}}
	\newcommand{\phinfour}{\euler(N)/4}
	
	\newcommand{\skS}{\sk}
	\newcommand{\pkS}{\pk}
	\newcommand{\SIGID}{\SIG[\IDSch]}
	\newcommand{\pkD}{\pk_b}
	\newcommand{\pkMinD}{\pk_{1-b}}
	
	
	%Signature impossibility:
	\newcommand{\Reduc}{\mathcal{R}}
	\newcommand{\OMDL}{1\text{-}\notionfont{OMDL}}
	\newcommand{\AdvM}{\mathcal{M}}
	\newcommand{\ImpKoaRo}{\IMP\KOA^\RO}
	
	
	\newcommand{\ListSig}{\List{\mathcal{S}}}
	\newcommand{\ListCorr}{\List{\mathcal{C}}}
	\newcommand{\MUUFCMA}{\mathsf{MU}\allowbreak\mbox{-}\mathsf{UF}\allowbreak\mbox{-}\mathsf{CMA}}
	\newcommand{\UFCMA}{\mathsf{UF}\mbox{-}\mathsf{CMA}}
	\newcommand{\GHashO}{\orfont{G}}
	\newcommand{\pkia}{\pk_{i,0}}
	\newcommand{\pkib}{\pk_{i,1}}
	\newcommand{\pkMiniD}{\pk_{i,1-b}}
	\newcommand{\skia}{\sk_{i,0}}
	\newcommand{\skib}{\sk_{i,1}}
	\newcommand{\skiD}{\sk_{i,b}}
	\newcommand{\skMiniD}{\sk_{i,1-b}}
	\newcommand{\oracleO}{\orfont{o}}
	\newcommand{\mstar}{\mes^{\star}}
	\newcommand{\STATED}{\STATE}
	\newcommand{\STATEMinD}{\STATE'}
	\newcommand{\MinD}{1-\bitSide}
	\newcommand{\ListHashAO}{\mathcal{L}_1}
	\newcommand{\ListHashBO}{\mathcal{L}_2}
	
	
	\newcommand{\AdvGi}[1]{\Pr[\Game_{#1}^\advA \Rightarrow 1]}
	
	%id scheme from cdh
	\newcommand{\IDCDH}{\algfont{ID}_\CDH}
	\newcommand{\BadCdhHVZK}{\eventfont{BAD}_{\HVZK}}
	
	\newcommand{\tdSim}{t}
	\newcommand{\hSim}{\tilde{h}}
	\newcommand{\hSima}{\hSim_{0}}
	\newcommand{\hSimb}{\hSim_{1}}
	\newcommand{\hSimD}{\hSim_{\bitSide}}
	\newcommand{\hSimMinD}{\hSim_{1-\bitSide}}
	\newcommand{\skSim}{\sk_{\Sim}}
	\newcommand{\skSima}{{\skSim}_0}
	\newcommand{\skSimb}{{\skSim}_1}
	\newcommand{\skSimD}{{\skSim}_\bitSide}
	\newcommand{\skSimMinD}{{\skSim}_{1-\bitSide}}
	\newcommand{\Priv}{\notionfont{Priv}\text{-}}
	
	% generic signature
	\newcommand{\mufcma}{\notionfont{MufCMA}}
	\newcommand{\NIWI}{\notionfont{NIWI}}
	% 3-move identification
	\newcommand{\SigCDH}{\SIG_\CDH}
	\newcommand{\ChamHash}{\varfont{W}}
	\newcommand{\SIGpk}{\pk}
	\newcommand{\SIGsk}{\sk}
	\newcommand{\Rsp}{\varfont{v}}
	\newcommand{\RandCham}{\varfont{u}}
	\newcommand{\CHA}{\CH_0}
	\newcommand{\CHB}{\CH_1}
	
	
	\newcommand{\GGMvar}{x}
	\newcommand{\Ca}{C_1}
	\newcommand{\Cb}{C_2}
	\newcommand{\fa}{f_1}
	\newcommand{\fb}{f_2}
	\newcommand{\fc}{f_3}
	\newcommand{\GGMvari}{\GGMvar_i}
	\newcommand{\OracleG}{\Oracle_{\G}}
	\newcommand{\ListGGM}{\List{\G}}
	\newcommand{\GGMcnt}[1]{\varfont{C}_{#1}}
	\newcommand{\NumGGMQuery}{{Q}_{\G}}
	\newcommand{\xN}{\GGMvar_1\ldots \GGMvar_{\NumUser}}
	\newcommand{\LenListGGM}{\cnt}
	\newcommand{\SIGcnt}{\varfont{C}_{\SIG}}
	\newcommand{\CIdlog}{\algfont{CorrIDLOG}}
	\newcommand{\CorrIDL}{\CIdlog}
	\newcommand{\Idlog}{\algfont{IDLOG}}
	\newcommand{\BadColl}{\eventfont{BadColl}}
	\newcommand{\BadGGM}{\eventfont{Bad}_\G}
	\newcommand{\AdvCIdlog}{\Adv^{\CIdlog}_{\G, \GGM}}
	
	\newcommand{\tightimply}{\imply{\text{tight}}} %dollar on arrow
	
	
	\newcommand{\TrapHa}{\mathsf{G}}
	\newcommand{\pkpre}{\pkS,}
	\newcommand{\thv}{h'}
	\newcommand{\codehl}[1]{\colorbox{black!20}{#1}}
	\newcommand{\emptystr}{\epsilon}
	
	
	%GAKE
	\newcommand{\Gake}{\algfont{GAKE}}
	\newcommand{\GKE}{\algfont{GKE}}
	\newcommand{\BDGKE}{\GKE_{\mathsf{BD}}}
	\newcommand{\GAKEsecurityPFSGame}{\GakeFS}
	\newcommand{\GakeGen}{\algfont{\Gen}_{\Gake}}
	\newcommand{\GakeIni}{\algfont{Init}}
	\newcommand{\GakeRes}{\algfont{Res}}
	\newcommand{\GakeDer}{\algfont{Der}}
	
	\newcommand{\PartySet}{\setfont{P}}
	\newcommand{\User}[1][]{\Party_{#1}}
	\newcommand{\GakePk}[1][]{\pk_{#1}}
	\newcommand{\GakeSk}[1][]{\sk_{#1}}
	
	\newcommand{\GakeIniMes}{m}
	\newcommand{\GakeIniResMes}{{\messageIniRes}}
	\newcommand{\GakeIniMesSet}[1][]{\mathcal{M}_{#1}}
	\newcommand{\GIniMesSet}{\mathcal{M}}
	\newcommand{\GakeIniSigSet}{\sigma_{\mathsf{I}}}
	\newcommand{\GakeResMes}{\hat{m}}
	\newcommand{\GakeResMesSet}[1][]{\hat{\mathcal{M}}_{#1}}
	\newcommand{\GResMesSet}{\hat{\mathcal{M}}}
	\newcommand{\GakeResSigSet}{\pi_{\mathsf{R}}}
	\newcommand{\GakeState}[1][]{\state_{#1}}
	
	\newcommand{\GkeState}[1][]{\hat{\state_{#1}}}
	%\newcommand{\GakeUSet}[1][]{\mathcal{Q}_{#1}}
	\newcommand{\GakeUSet}{\mathcal{Q}}
	\newcommand{\GakeUsIDSet}{\mathcal{S}_{\GakeGScnt}}
	\newcommand{\GakeSessKey}[1][]{\varfont{K}_{#1}}
	\newcommand{\GakeFS}{\mathsf{IND\hyphen G\hyphen FS}}
	\newcommand{\GakeIniO}{\orfont{Session}_\mathsf{I}}
	\newcommand{\GakeResO}{\orfont{Session}_\mathsf{R}}
	\newcommand{\GakeDerO}{\orfont{Der}}
	\newcommand{\GakeUId}{i}
	\newcommand{\GakeGScnt}{k}
	\newcommand{\nparty}{\kappa}  % n-party key exchange
	\newcommand{\responders}{\mathcal{R}}
	\newcommand{\initiators}{\mathcal{I}}
	%\newcommand{\parties}{\text{users}}
	\newcommand{\GIni}{i}
	\newcommand{\owner}{\text{owner}}
	\newcommand{\peer}{\text{peer}}
	\newcommand{\peers}{\mathcal{P}}
	\newcommand{\numpeers}{n}
	\newcommand{\GIniMes}{\changehighlight{\mathsf{Msg_I}}}
	\newcommand{\GResMes}{\changehighlight{\mathsf{Msg_R}}}
	\newcommand{\Gstate}{\state}
	\newcommand{\Gstates}{\states}
	
	\newcommand{\GakeIniGroup}{\notionfont{iniG}}
	\newcommand{\GakeDerUser}{\notionfont{derU}}
	\newcommand{\sIDIni}{\sID'}
	\newcommand{\GakeIniUsID}{\sIDIni}
	\newcommand{\GakeResUsID}{\sID}
	\newcommand{\GakeTypeIni}{\text{``In''}}
	\newcommand{\GakeTypeRes}{\text{``Re''}}
	\newcommand{\sIDSet}{\notionfont{sIDSet}}
	\newcommand{\sIDSetIni}{\sIDSet_{I}}
	\newcommand{\sIDSetRes}{\sIDSet_{R}}
	\newcommand{\ListsId}{\List{User}}
	\newcommand{\ListIniID}{\List{\GakeIni}}
	\newcommand{\ListResID}{\List{\GakeRes}}
	
	\newcommand{\ListGakeIniMes}{\GIniMes}
	\newcommand{\ListTempIniMes}{\List{I}}
	\newcommand{\ListGakeResMes}{\GResMes}
	\newcommand{\ListTempResMes}{\List{R}}
	\newcommand{\ListGakeStates}{\Gstates}
	\newcommand{\ListGakeSessKey}{\skeys}
	\newcommand{\sIDi}{\sID_{i}}
	\newcommand{\SchnorrSch}{\mathsf{Schnorr}}
	
	\newcommand{\MsgTypeA}{``1st''}
	\newcommand{\MsgTypeB}{``2nd''}
	\newcommand{\MsgTypeDer}{``Der''}
	
	\newcommand{\gakebilinpair}{e}
	%passive security
	\newcommand{\GOWPV}{\mathsf{OW\hyphen \allowbreak G\hyphen \allowbreak HV}}
	\newcommand{\GakeExecuteO}{\mathsc{Exe}}
	\newcommand{\GakeKeyvfyO}{\mathsc{KVer}}
	\newcommand{\peerssID}{\{\sID_j\}_{j \in [|\peers|]}}
	
	\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
	\newcommand{\DLO}{\textsc{Dl}}
	\newcommand{\NumDLQuery}{Q_{\DLO}}
	
	\renewcommand{\star}{*}
	\newcommand{\rstar}{r^*}
	\newcommand{\valFinH}{1}
	\newcommand{\invalFinH}{0}
	
	
	\newcommand{\randSpace}{R}
	
	
	%generic transformation
	\newcommand{\AbortSessR}{\mathsf{AbortSessR}}
	\newcommand{\AbortGvke}{\mathsf{AbortGAKE}}
	
	\newcommand{\JKRS}{\textsf{JKRS}}
	
	
	%factoring assumption
	\newcommand{\PN}{\mathbb{P}_{n/2}}
	\newcommand{\SCDHN}{\SCDH_N}
	
	%\newcommand{\changehighlight}[1]{\textcolor{blue}{#1}}
	\newcommand{\changehighlight}[1]{#1}